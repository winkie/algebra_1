\section{Факториальные кольца. Задача о разложении полиномов на множители в кольце многочленов. Приведение к случаю полинома свободного от квадратов.}

\begin{thm}
  Кольцо многочленов факториально. \newline
\end{thm}

Пусть $ F_{q} $ - поле. char$(F_q) = p $. \newline

\emph{Постановка задачи о разложении на множители:} \newline

Пусть $ f \in F_{q}[x],  f = \overset{m}{\underset{i = 1}{\prod}} f_i^{\alpha_i},
 (f_i^{\alpha_i}, f_j^{\alpha_j}) = 1 $. Требуется найти: $ m, f_i, \alpha_i $

\begin{defn}
  $ f \in F_{q}[x] $ будем называть \emph{свободным от квадратов}, если $ \forall i ~~ \alpha_i = 1 $.
\end{defn}

\begin{defn}
  $ D : A \rightarrow A $ будем называть \emph{дифференциальным оператором}, если 
  \begin{enumerate}
    \item $ D({\alpha}f + {\beta}g) = {\alpha}Df + {\beta}Dg $
    \item $ D(fg) = D(f)g + D(g)f $
  \end{enumerate}
\end{defn}

Рассмотрим $ D : F_q[x] \rightarrow F_q[x], D(x^n) = nx^{n-1}, D(x^{n}x_{m}) = D(x^n)x^m + D(x^m)x^n $, 
в частности $ D(x^2) = 2xD(x) $. Можно показать,что других дифференциальных операторов нет.

Далее покажем как свести задачу разложения полинома на множители к задаче разложения на множители соответствующего
свободного от квадратов полинома.

Пусть \[ f(x) = \phi(x)^2 \] тогда \[ f(x)' = 2\phi(x)\phi(x)'g(x) + \phi(x)^2g(x)' \]
Заметим, что $ f ~ \vdots ~ \phi $ и $ f' ~ \vdots ~ \phi $ и значит $ (f, f') ~ \vdots ~ \phi $.

\begin{lem}
  $ f \in \BB{K}[x], char(\BB{K}) = p, f' = 0 $, тогда $ \exists g(x) : f(x) = g(x)^p $. 
\end{lem}

\begin{proof}
  \[ f = \overset{n}{\underset{i=0}{\sum}} c_{i}x^{i} \]
  \[ f' = \overset{n}{\underset{i=0}{\sum}} ic_{i}x^{i - 1} = 0 \]
  Тогда $ \forall i ~~ ic_i = 0, c_i \ne 0 $, то есть $ \forall i ~~ i ~ \vdots ~ p $. 
  Перепишем $ f $ с учетом последних наблюдений.
  \[ \overset{s}{\underset{j = 0}{\sum}} c_{pj}x^{pj} \]
  Таким образом, если $ f' = 0 $, то $ x $ входит в $ f $ со степенями кратными $ p $. Другими словами
  $ f(x)' = 0 \Rightarrow f(x) = g(x^p) $. 
  Рассмотрим $ \frob(g(x)) = ({\sum}a_ix^i)^p = {\sum}a_ix^{ip} = g(x)^p = \frob(g(x)) $, так как $ \frob $ -
  линейный оператор. 
\end{proof}

Теперь можно сформулировать алгоритм приведения $ f $ к полиному свободному от квадратов. Предыдущая лемма
позволяет считать, что $ f' \ne 0 $, так как если $ f' = 0 $, то $ f $ можно заменить на $ g(x)^p $ и искать
разложение $ g(x) $. \newline  \newline
{\bf{Вход}}: $ f(x) \in F_q[x] $ {\bf{Выход}}: $ \overset{\sim}{f} $ - свободный от квадратов \newline

\begin{codebox}
  \Procname{Освобождение от квадратов}
    \li $ S \gets \emptyset $ \Comment $ S $ - хранилище собственных множителей $ f(x) $
    \li \While true
      \li \Do $ h(x) \gets (f(x), f(x)') $ \Comment алгоритм Евклида
      \li \If $ h(x) = 1 $ 
        \li \Do \Return \Comment $ f(x) $ - свободен от квадратов
	\li \End
      \li \If $ h(x) \ne 1 $
       \li \Comment Запоминаем $ h(x) $
        \li \Do $ S \gets h(x) $ 
	  \li $ f(x) \gets f(x) / h(x) $
\end{codebox}

Ясно, что в дальнейшем для получения разложения $ f $ на множители необходимо будет разложить на множители
соответствующий ему свободный от квадратов полином, а также полиномы $ h(x) $ сохраненные в $ S $.



